id: CVE-2025-26519
info:
  name: "musl libc iconv Out-of-Bounds Write Vulnerability"
  version: "1.0"
  author: "Sirius Template Factory"
  severity: high
  description: "Detects musl libc versions 0.9.13 through 1.2.5 vulnerable to CWE-787 out-of-bounds write in iconv EUC-KR decoder. Affects Alpine Linux 3.18, 3.19, 3.20 and other musl-based distributions."
  cve:
    - CVE-2025-26519
  tags:
    - musl
    - libc
    - iconv
    - euc-kr
    - out-of-bounds-write
  references:
    - https://www.openwall.com/lists/oss-security/2025/02/13/
    - https://git.musl-libc.org/cgit/musl/commit/?id=e5adcd97b5196e29991b524237381a0202a60659
    - https://git.musl-libc.org/cgit/musl/commit/?id=c47ad25ea3b484e10326f933e927c0bc8cded3da
  cvss_score: 8.1
  cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"

detection:
  logic: any
  steps:
    # x86_64 architecture (most common in servers and containers)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-x86_64.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # aarch64 architecture (ARM64, increasingly common in cloud and mobile)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-aarch64.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # i386 architecture (32-bit, legacy systems)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-i386.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # arm architecture (ARMv7, embedded systems)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-arm.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # armhf architecture (ARM hard float, Raspberry Pi, etc.)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-armhf.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # s390x architecture (IBM mainframes)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-s390x.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # riscv64 architecture (RISC-V, emerging architecture)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-riscv64.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"

    # ppc64 architecture (PowerPC 64-bit)
    - type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-ppc64.so.1"]
        regex: "Version\\s+([0-9]+\\.[0-9]+\\.[0-9]+)"
