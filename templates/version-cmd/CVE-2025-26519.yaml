id: CVE-2025-26519
info:
  name: "musl libc iconv EUC-KR Buffer Overflow"
  author: "Sirius Template Factory"
  severity: high
  description: "Detects musl libc versions 0.9.13 through 1.2.5 vulnerable to CVE-2025-26519 (iconv EUC-KR to UTF-8 out-of-bounds write). The vulnerability allows remote code execution through malicious EUC-KR encoded input."
  version: "1.0"
  cve:
    - CVE-2025-26519
  tags:
    - musl
    - libc
    - iconv
    - buffer-overflow
    - rce
  cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H"
  cvss_score: 8.1
  references:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-26519
    - https://www.musl-libc.org/
    - https://git.musl-libc.org/cgit/musl/commit/?id=c47ad25ea3b484e10326f933e927c0bc8cded3da
    - https://git.musl-libc.org/cgit/musl/commit/?id=e5adcd97b5196e29991b524237381a0202a60659
    - https://www.openwall.com/lists/oss-security/2025/02/13/2

detection:
  logic: any
  steps:
    - name: "Check musl libc version (aarch64)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-aarch64.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (x86_64)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-x86_64.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (32-bit ARM)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-arm.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (x86 32-bit)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-i386.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (IBM s390x)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-s390x.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (PowerPC 64-bit LE)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-ppc64le.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (RISC-V 64-bit)"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/lib/ld-musl-riscv64.so.1", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (custom /tmp path)"
      type: version_cmd
      platforms:
        - linux
      weight: 0.9
      config:
        command: ["/tmp/musl/lib/libc.so", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (custom /opt path)"
      type: version_cmd
      platforms:
        - linux
      weight: 0.9
      config:
        command: ["/opt/musl/lib/libc.so", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

    - name: "Check musl libc version (custom /usr/local path)"
      type: version_cmd
      platforms:
        - linux
      weight: 0.9
      config:
        command: ["/usr/local/musl/lib/libc.so", "--version"]
        regex: "Version ([0-9]+\\.[0-9]+\\.[0-9]+)"
        exit_code: 1

metadata:
  affected_product: "musl libc"
  affected_versions:
    minimum: "0.9.13"
    maximum: "1.2.5"
  fixed_version: "1.2.6"
  component: "iconv (character set conversion)"
  vulnerability_type: "Out-of-bounds Write / Buffer Overflow"
  attack_vector: "Network"
  attack_complexity: "Low"
  privileges_required: "None"
  user_interaction: "Required"
  scope: "Unchanged"
  confidentiality_impact: "High"
  integrity_impact: "High"
  availability_impact: "High"

remediation:
  recommended_action: "Upgrade musl libc to version 1.2.6 or later"
  alpine_linux: "Update Alpine Linux packages: apk update && apk upgrade musl"
  fedora_rhel: "Update via package manager or rebuild from source with patched musl"
  debian_ubuntu: "musl not default; if used, update to 1.2.6+"
  source_build: "Rebuild musl libc from source with patches c47ad25ea3b484e10326f933e927c0bc8cded3da and e5adcd97b5196e29991b524237381a0202a60659"
  timeline: "Patch released: 2025-02-13"
