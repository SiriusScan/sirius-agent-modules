id: CRED-001
info:
  name: Git Credentials Stored in Plaintext
  vulnerability_id: CWE-256
  version: "1.0.0"
  author: "Sirius Team"
  severity: high
  description: "Detects the presence of ~/.git-credentials file which stores Git credentials in plaintext. This file may contain passwords or personal access tokens that can be compromised if the system is accessed."
  cwe:
    - CWE-256
    - CWE-522
  references:
    - https://cwe.mitre.org/data/definitions/256.html
    - https://git-scm.com/docs/git-credential-store
    - https://git-scm.com/book/en/v2/Git-Tools-Credential-Storage
  tags:
    - credentials
    - git
    - plaintext
    - hardening
  remediation: "Use a secure credential helper instead of credential.store. On macOS use 'git config --global credential.helper osxkeychain'. On Linux use 'git config --global credential.helper cache' or integrate with a secret manager. Delete ~/.git-credentials and rotate any stored credentials."

detection:
  logic: any
  steps:
    - name: "Check for git-credentials file existence"
      type: version_cmd
      platforms:
        - linux
        - darwin
      weight: 1.0
      config:
        command:
          [
            "sh",
            "-c",
            "test -f ~/.git-credentials && echo 'GIT_CREDENTIALS_EXISTS'",
          ]
        regex: "GIT_CREDENTIALS_EXISTS"
