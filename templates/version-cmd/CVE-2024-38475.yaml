id: CVE-2024-38475
info:
  name: "Apache HTTP Server mod_rewrite Output Escaping Vulnerability"
  author: "Sirius Template Factory"
  severity: critical
  description: "Detects Apache HTTP Server versions vulnerable to CVE-2024-38475. Improper escaping of output in mod_rewrite allows URL mapping to unintended filesystem locations, potentially leading to information disclosure or remote code execution."
  version: "1.0"
  cve:
    - CVE-2024-38475
  tags:
    - apache
    - httpd
    - mod_rewrite
    - cve-2024
    - rce
  references:
    - https://httpd.apache.org/security/vulnerabilities_24.html
    - https://nvd.nist.gov/vuln/detail/CVE-2024-38475
  cvss_vector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
  cvss_score: 9.1

detection:
  logic: any
  steps:
    - name: "Check Apache version via /usr/bin/httpd"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/usr/bin/httpd", "-v"]
        regex: "Server version: Apache/(\\d+\\.\\d+\\.\\d+(-\\w+)?)"
        exit_code: 0

    - name: "Check Apache version via /usr/sbin/apache2"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/usr/sbin/apache2", "-v"]
        regex: "Server version: Apache/(\\d+\\.\\d+\\.\\d+(-\\w+)?)"
        exit_code: 0

    - name: "Check Apache version via /usr/sbin/httpd"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/usr/sbin/httpd", "-v"]
        regex: "Server version: Apache/(\\d+\\.\\d+\\.\\d+(-\\w+)?)"
        exit_code: 0

    - name: "Check Apache version via /usr/local/apache2/bin/httpd"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/usr/local/apache2/bin/httpd", "-v"]
        regex: "Server version: Apache/(\\d+\\.\\d+\\.\\d+(-\\w+)?)"
        exit_code: 0

    - name: "Check Apache version via /usr/local/bin/httpd"
      type: version_cmd
      platforms:
        - linux
      weight: 1.0
      config:
        command: ["/usr/local/bin/httpd", "-v"]
        regex: "Server version: Apache/(\\d+\\.\\d+\\.\\d+(-\\w+)?)"
        exit_code: 0
