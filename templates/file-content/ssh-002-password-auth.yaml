id: SSH-002
info:
  name: SSH Password Authentication Enabled
  vulnerability_id: CWE-287
  version: "1.0.0"
  author: "Sirius Team"
  severity: medium
  description: "Detects SSH servers configured to allow password authentication. Password authentication is weaker than key-based authentication and is susceptible to brute-force attacks."
  cwe:
    - CWE-287
  references:
    - https://cwe.mitre.org/data/definitions/287.html
    - https://man.openbsd.org/sshd_config
    - https://www.ssh.com/academy/ssh/public-key-authentication
  tags:
    - ssh
    - misconfiguration
    - authentication
    - hardening
  remediation: "Set 'PasswordAuthentication no' in /etc/ssh/sshd_config and ensure all users have SSH keys configured. Restart the SSH service after making changes."

detection:
  logic: any
  steps:
    - name: "Check sshd_config for PasswordAuthentication yes"
      type: file_content
      platforms:
        - linux
        - darwin
      weight: 1.0
      config:
        path: "/etc/ssh/sshd_config"
        regex: "^\\s*PasswordAuthentication\\s+yes"
