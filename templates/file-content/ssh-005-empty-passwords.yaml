id: SSH-005
info:
  name: SSH Empty Passwords Allowed
  vulnerability_id: CWE-258
  version: "1.0.0"
  author: "Sirius Team"
  severity: critical
  description: "Detects SSH servers configured to permit login with empty passwords. This is an extremely dangerous misconfiguration that allows unauthenticated access to accounts with blank passwords."
  cwe:
    - CWE-258
  references:
    - https://cwe.mitre.org/data/definitions/258.html
    - https://man.openbsd.org/sshd_config
    - https://www.ssh.com/academy/ssh/sshd_config
  tags:
    - ssh
    - misconfiguration
    - authentication
    - critical
    - hardening
  remediation: "Set 'PermitEmptyPasswords no' in /etc/ssh/sshd_config and restart the SSH service. Ensure all user accounts have strong passwords set."

detection:
  logic: any
  steps:
    - name: "Check sshd_config for PermitEmptyPasswords yes"
      type: file_content
      platforms:
        - linux
        - darwin
      weight: 1.0
      config:
        path: "/etc/ssh/sshd_config"
        regex: "^\\s*PermitEmptyPasswords\\s+yes"
